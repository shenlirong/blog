---
icon: pen-to-square
# date: 2024-12-01
sticky: 94
# star: true
category:
  - å‰ç«¯å¼€å‘
---

<!-- more -->
# é˜²æŠ–èŠ‚æµçš„åŒºåˆ«
# é˜²æŠ–ä¸èŠ‚æµæŠ€æœ¯è¯¦è§£
é˜²æŠ–ï¼ˆDebounceï¼‰å’ŒèŠ‚æµï¼ˆThrottleï¼‰æ˜¯ä¸¤ç§å¸¸ç”¨çš„å‰ç«¯æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºæ§åˆ¶å‡½æ•°æ‰§è¡Œé¢‘ç‡ã€‚å®ƒä»¬éƒ½èƒ½æœ‰æ•ˆå‡å°‘é«˜é¢‘äº‹ä»¶å¤„ç†å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ï¼Œä½†å®ç°åŸç†å’Œåº”ç”¨åœºæ™¯æœ‰æ‰€ä¸åŒã€‚
## ğŸš¥ æ ¸å¿ƒå·®å¼‚å¯¹æ¯”
|ç‰¹æ€§|é˜²æŠ–ï¼ˆDebounceï¼‰|èŠ‚æµï¼ˆThrottleï¼‰|
| :----- | :----- | :---- |
|æœ¬è´¨|å»¶è¿Ÿæ‰§è¡Œ|ç¨€é‡Šæ‰§è¡Œ|
|æ‰§è¡Œæ—¶æœº|äº‹ä»¶åœæ­¢è§¦å‘å|å›ºå®šæ—¶é—´é—´éš”|
|å¤šæ¬¡è§¦å‘|åªæ‰§è¡Œæœ€åä¸€æ¬¡|å‡åŒ€æ‰§è¡Œ|
|ä¿è¯å“åº”|âŒ å¯èƒ½æ°¸è¿œä¸æ‰§è¡Œï¼ˆæŒç»­è§¦å‘ï¼‰|âœ… ä¿è¯è‡³å°‘æ‰§è¡Œä¸€æ¬¡|
|åº”ç”¨åœºæ™¯|è¾“å…¥æ¡†éªŒè¯ã€æœç´¢å»ºè®®|æ»šåŠ¨åŠ è½½ã€çª—å£è°ƒæ•´ã€æŒ‰é’®é˜²é‡å¤ç‚¹å‡»|
|æ°´ç®¡æ¯”å–»|ç­‰æ°´æµå®Œå…¨åœæ­¢å†å“åº”|æ§åˆ¶æ°´æµæµé‡åŒ€é€Ÿé‡Šæ”¾|

## ğŸ§© æŠ€æœ¯å®ç°ä¸ä»£ç ç¤ºä¾‹
### é˜²æŠ–å®ç°ï¼ˆDebounceï¼‰
```javascript
function debounce(fn, delay) {
  let timer = null;
  
  return function(...args) {
    // æ¯æ¬¡è§¦å‘éƒ½æ¸…é™¤ä¸Šä¸€æ¬¡çš„è®¡æ—¶
    clearTimeout(timer); 
    
    // é‡æ–°è®¾ç½®è®¡æ—¶å™¨
    timer = setTimeout(() => {
      fn.apply(this, args);
    }, delay);
  };
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šè¾“å…¥æ¡†æœç´¢å»ºè®®
const searchInput = document.querySelector('#search');
searchInput.addEventListener('input', debounce(() => {
  console.log('å‘é€æœç´¢è¯·æ±‚', searchInput.value);
}, 500));
```
### èŠ‚æµå®ç°ï¼ˆThrottleï¼‰
```javascript
function throttle(fn, interval) {
  let lastTime = 0;
  
  return function(...args) {
    const now = Date.now();
    
    // åˆ¤æ–­æ˜¯å¦è¾¾åˆ°æ‰§è¡Œæ—¶é—´é—´éš”
    if (now - lastTime >= interval) {
      fn.apply(this, args);
      lastTime = now;
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šæ»šåŠ¨åŠ è½½
window.addEventListener('scroll', throttle(() => {
  console.log('æ£€æŸ¥æ»šåŠ¨ä½ç½®åŠ è½½æ•°æ®');
}, 1000));
```
## ğŸ“Š è§¦å‘é¢‘ç‡å¯è§†åŒ–åˆ†æ
å‡è®¾ç”¨æˆ·è¿ç»­è§¦å‘äº‹ä»¶çš„æ—¶é—´ç‚¹ï¼š
```
è§¦å‘æ—¶é—´ï¼š|---â—--â—---â—---â—---â—---â—---> (æ—¶é—´è½´)
```
é˜²æŠ–è¡¨ç°ï¼ˆå»¶è¿Ÿ500msï¼‰ï¼š
```
è§¦å‘äº‹ä»¶: â— â— â— â— â— â— â— â— â—
æ‰§è¡Œæ—¶æœº:                  â˜… (åœæ­¢è§¦å‘500msåæ‰§è¡Œ)
```
èŠ‚æµè¡¨ç°ï¼ˆé—´éš”500msï¼‰ï¼š
```
è§¦å‘äº‹ä»¶: â— â— â— â— â— â— â— â— â—
æ‰§è¡Œæ—¶æœº:     â˜…     â˜…     â˜… (æ¯500msæ‰§è¡Œä¸€æ¬¡)
```
## ğŸ† ç»å…¸åº”ç”¨åœºæ™¯
### é€‚åˆé˜²æŠ–çš„åœºæ™¯
**1. æ–‡æœ¬è¾“å…¥éªŒè¯**ï¼šç­‰å¾…ç”¨æˆ·åœæ­¢è¾“å…¥åå†æ£€æŸ¥æ ¼å¼
**2. æœç´¢æ¡†å»ºè®®**ï¼šé¿å…ç”¨æˆ·è¾“å…¥æ¯ä¸ªå­—ç¬¦éƒ½å‘é€è¯·æ±‚
**3. çª—å£å¤§å°è°ƒæ•´ç»“æŸ**ï¼šç­‰å¾…è°ƒæ•´å®Œæˆåè®¡ç®—å¸ƒå±€
**4. è‡ªåŠ¨ä¿å­˜åŠŸèƒ½**ï¼šåœæ­¢ç¼–è¾‘ä¸€æ®µæ—¶é—´åä¿å­˜
### é€‚åˆèŠ‚æµçš„åœºæ™¯
**1. æ»šåŠ¨äº‹ä»¶å¤„ç†**ï¼šæ»šåŠ¨è¿‡ç¨‹ä¸­å®šæœŸæ£€æŸ¥ä½ç½®
**2. é¼ æ ‡ç§»åŠ¨è·Ÿè¸ª**ï¼šæ¸¸æˆä¸­çš„é¼ æ ‡ä½ç½®æ›´æ–°
**3. é™åˆ¶é«˜é¢‘æŒ‰é’®ç‚¹å‡»**ï¼šé˜²æ­¢ç”¨æˆ·è¿ç»­æäº¤è¡¨å•
**4. æ»‘åŠ¨æ“ä½œåé¦ˆ**ï¼šæ»‘åŠ¨è¿‡ç¨‹ä¸­å®æ—¶æ›´æ–°UI
## ğŸ” é«˜çº§å®ç°æŠ€å·§
### å¸¦ç«‹å³æ‰§è¡Œçš„é˜²æŠ–
```javascript
function debounce(fn, delay, immediate = false) {
  let timer = null;
  
  return function(...args) {
    const shouldCallImmediately = immediate && !timer;
    
    clearTimeout(timer);
    
    timer = setTimeout(() => {
      if (!immediate) fn.apply(this, args);
      timer = null;
    }, delay);
    
    if (shouldCallImmediately) {
      fn.apply(this, args);
    }
  };
}
```
### å¸¦å°¾éƒ¨æ‰§è¡Œçš„èŠ‚æµ
```javascript
function throttle(fn, interval) {
  let lastTime = 0;
  let timer = null;
  
  return function(...args) {
    const now = Date.now();
    const remaining = interval - (now - lastTime);
    
    if (remaining <= 0) {
      if (timer) {
        clearTimeout(timer);
        timer = null;
      }
      fn.apply(this, args);
      lastTime = now;
    } else if (!timer) {
      timer = setTimeout(() => {
        fn.apply(this, args);
        lastTime = Date.now();
        timer = null;
      }, remaining);
    }
  };
}
```
## ğŸ§ª å®æˆ˜é€‰æ‹©å»ºè®®
**1. éœ€è¦å“åº”ç¬¬ä¸€æ¬¡æ“ä½œ** â†’ å¸¦ç«‹å³æ‰§è¡Œçš„é˜²æŠ–
**2. éœ€è¦å“åº”æœ€åä¸€æ¬¡æ“ä½œ** â†’ é˜²æŠ–
**3. éœ€è¦å‡åŒ€é—´éš”å“åº”** â†’ èŠ‚æµ
**4. éœ€è¦ä¿è¯è‡³å°‘æ‰§è¡Œä¸€æ¬¡** â†’ èŠ‚æµ
**5. é«˜ç²¾åº¦äº¤äº’åœºæ™¯** â†’ requestAnimationFrame
## ğŸ’¡ å¯è§†åŒ–å†³ç­–æµç¨‹
```mermaid
graph TD
    A[éœ€è¦å¤„ç†é«˜é¢‘äº‹ä»¶] --> B{æ˜¯å¦éœ€è¦å“åº”æ¯æ¬¡æ“ä½œ}
    B -->|æ˜¯| C[ä½¿ç”¨èŠ‚æµ]
    B -->|å¦| D{æ˜¯å¦éœ€è¦å“åº”æœ€åä¸€æ¬¡æ“ä½œ}
    D -->|æ˜¯| E[ä½¿ç”¨é˜²æŠ–]
    D -->|å¦| F[ä½¿ç”¨èŠ‚æµ]
```
ç†è§£é˜²æŠ–å’ŒèŠ‚æµçš„åŒºåˆ«ï¼Œå¯ä»¥æ ¹æ®å…·ä½“ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥ï¼Œæ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½ä¸ç”¨æˆ·ä½“éªŒã€‚